# RWA 平台 6 个月极简版方案（Solana；KYC/审计弱化、无 MPC）

> 目标：**6 个月**内用最小可行集合（MVP++）在 **Solana** 跑通：发行 → 认购 → 收益分配 → 赎回（到期/回购），**不含复杂二级流转**、**KYC/审计弱化**、**不启用 MPC**。为后续 12+ 个月的合规增强与 Sui 平行部署预留升级路径。

---

## 目录
- [1. 取舍与边界](#1-取舍与边界)
- [2. 最小功能清单（Must/Should/Could）](#2-最小功能清单mustshouldcould)
- [3. 链上 Program（极简 5–7 个）](#3-链上-program极简-57-个)
- [4. 链下系统](#4-链下系统)
- [5. 里程碑（6 个月）](#5-里程碑6-个月)
- [6. 合约规模与团队](#6-合约规模与团队)
- [7. 风险与控制点（在弱化合规前提下）](#7-风险与控制点在弱化合规前提下)
- [8. 升级路径（6→12 个月）](#8-升级路径612-个月)
- [9. 仓库结构建议](#9-仓库结构建议)
- [10. 配置示例](#10-配置示例)

---

## 1. 取舍与边界

- **KYC 弱化**：前期仅做轻量校验（手机号/邮箱 + 基本制裁名单 API），**不做链上 KYC Registry**，由后台风控放行。  
- **转让限制**：**不做 Token-2022 Transfer Hook**；**不开放自由二级市场**。如需转让，使用 **托管式 OTC**（后台撮合+单笔白名单审批），上线到第 5 个月再考虑。  
- **审计弱化**：不做外部审计；采用 **静态分析 + 单/集成测试 + 最小化权限**；第 6 月做一次 **安全复核/代码冻结**。  
- **无 MPC**：平台金库先用 **多签（如 Squads 2-of-3）或单签 + 冷备**（小额金库），配合**提现白名单与限额**。  
- **资产形态**：**经典 SPL Token（非 Token-2022）**，最大化兼容性与交付速度。  
- **业务闭环**：**仅做一级发行/认购、收益分配、赎回**；二级流转延后。

---

## 2. 最小功能清单（Must/Should/Could）

**Must（M1–M3 完成）**
1. 资产创建与发行（SPL Mint、Metadata、总量与价格参数）。  
2. 申购/配售/铸份额（USDC 入金至金库，超额退款）。  
3. 收益分配（Merkle 批次 + `claim` 领取）。  
4. 赎回/回购（到期按净值兑付 USDC，队列式处理）。  
5. 运营后台最小版（上架、认购轮管理、分配发布、赎回处理）。  
6. 投资者门户最小版（注册/登录、资产目录、认购、持仓、领取、提现指引）。

**Should（M4–M5 完成）**
1. 托管式 OTC（后台审核的点对点转让，链上由托管 Program 过桥）。  
2. 轻量风控规则（单笔/单日额度，地域黑名单，后台开关）。  
3. 预言机只读接入（Pyth 价格/指数用于 IR 展示，不参与强制清算）。

**Could（M6 完成/预留）**
1. 文档上链存证（审计/PPA 合同哈希）。  
2. App（Flutter）只读持仓与分配领取（也可延后）。

---

## 3. 链上 Program（极简 5–7 个）

| # | Program | 作用 | 备注 |
|---|---|---|---|
| 1 | **Access & Config** | 全局参数、角色、暂停 | 可合并 Pause |
| 2 | **Asset Mint Manager** | 创建/管理 SPL Mint + Metadata | 发行参数只存关键字段 |
| 3 | **Offering / Subscription** | 认购池、价格、配售、退款 | USDC 金库托管 |
| 4 | **Treasury / Fee Vault** | 资金与费用金库、白名单提现 | 多签或单签小额金库 |
| 5 | **Distribution (Merkle)** | 批次 root 存证、`claim` | 链下生成 Merkle 文件 |
| 6 | **Buyback / Redemption** | 到期/回购赎回 | 队列+金库扣款 |
| 7 | **OTC Custody（可选）** | 审批式托管转让 | 第 5 个月上线 |

> 代码规模：**~3k–6k SLOC**（Anchor），测试 > 合约行数的 1 倍为宜。

**指令流（节选）**
- `create_asset_mint(name, symbol, decimals, total_supply)`  
- `open_offering(asset_id, price_usdc, min_alloc, max_alloc, end_time)`  
- `subscribe(offering_id, amount_usdc)` → `settle_and_mint(allocation)`  
- `publish_distribution(batch_id, merkle_root, total, snapshot_slot)` → `claim(batch_id, amount, proof)`  
- `request_redeem(asset_id, amount)` → `process_redeem(queue_item)`

---

## 4. 链下系统

- **后台**（最小）：资产/认购管理、配售结算、分配批次生成（Merkle）、赎回队列、对账报表。  
- **门户**（最小）：注册/登录、资产目录、认购、持仓、领取。  
- **风控**：集中式（DB）KYC/黑名单/额度，链上不强制，仅在结算/铸币时由后台把关。  
- **对账**：USDC 收款地址归集 + 交易哈希对账；导出 CSV。  
- **监控**：金库余额阈值、交易失败重试、异常告警。

---

## 5. 里程碑（6 个月）

| 月份 | 交付 | 说明 |
|---|---|---|
| **M1** | PoC：SPL 发行 + 认购最小闭环 + 分配 `claim` | Devnet 跑通；合约骨架、索引器、脚本 |
| **M2** | MVP：门户/后台最小可用；首批小额试运营 | 真实小额度，灰度用户 |
| **M3** | 赎回功能 + 分配批量工具链 | 队列化兑付、对账报表 |
| **M4** | 轻量风控 + IR 看板 | 黑名单/额度、指标展示 |
| **M5** | 托管式 OTC（可选） | 审批制点对点转让 |
| **M6** | 稳定性与安全复核、代码冻结 | 静态分析、权限收敛、Runbook |

---

## 6. 合约规模与团队

- **Program 5–7 个**；核心逻辑 **3k–6k 行**；单测+e2e。  
- **团队（7-8 人）**  
  - 链上 2（Solana/Anchor）  
  - 后端 2（Go/Node/Rust 任一）  
  - 前端 2（Web/少量 Flutter）  
  - 产品/设计/PM 1–2

---

## 7. 风险与控制点（在弱化合规前提下）

- **法律合规**：技术弱化不代表合规豁免；仅面向小规模灰度用户，**不公开募资**。  
- **密钥与资金安全**：无 MPC 时，**强烈建议多签金库 + 提现白名单 + 限额**；单签只用于小额与测试。  
- **二级市场**：不开放自由转让，避免监管风险与合约复杂度。  
- **Merkle 分配**：生成/签名/上链全链路审计日志；错误批次可撤销/更正。  
- **回滚与暂停**：提供紧急暂停与只读模式；参数改动有延时锁（24h）。

---

## 8. 升级路径（6→12 个月）

- **合规模块**：引入 KYC Registry Program、Transfer Hook（Token-2022）或强制托管撮合。  
- **MPC**：平台金库从多签迁移至 MPC（阈值签名 + 审批流）。  
- **审计**：引入 1–2 家外部审计，覆盖发行、分配、赎回、OTC 全流程。  
- **Sui 并行**：按同一资源模型实现 Move 包（8–10 个），采用跨链 Merkle 根/事件镜像。  
- **App 完整化**：Flutter 上线签名、推送、KYC、领取与提现。

---

## 9. 仓库结构建议

```text
rwa-lite/
 ├─ programs/               # 5–7 个合约
 │   ├─ access/
 │   ├─ asset_mint/
 │   ├─ offering/
 │   ├─ treasury/
 │   ├─ distribution/
 │   ├─ redemption/
 │   └─ otc_custody/        # 可选
 ├─ app/                    # Web 前端
 ├─ backend/                # API/Indexer/Merkle 工具/对账
 ├─ ops/                    # IaC/部署/监控/Runbooks
 ├─ specs/                  # IDL/接口/分配文件格式
 └─ README.md
```

---

## 10. 配置示例

| 参数 | 缺省 |
|---|---|
| `fee_bps` | 50 (=0.5%) |
| `pause_flags` | 0 |
| `max_tx_amount` | 50,000 USDC |
| `daily_out_limit` | 200,000 USDC |
| `claim_deadline_days` | 365 |
| `redeem_window_days` | 7 |
| `timelock_hours` | 24 |

---
##  成本总表（人民币基准）
| # | 档位	 | 人力月薪假设（合计 | 间接成本系数 |人力月成本（含间接）|基建/月|月度 Burn|6 个月合计|
|---|---|---|---|---|---|---|---|
|档位	人力月薪假设（合计）	间接成本系数	人力月成本（含间接）	基建/月	月度 Burn	6 个月合计
|A 顶配一线	¥380,000	15%	¥437,000	¥20,000	¥457,000	¥2,742,000
|B 主流档	¥274,000	12%	¥307,000	¥12,000	¥319,000	¥1,914,000
|C 精益承包	¥200,000	10%	¥220,000	¥8,000	¥228,000	¥1,368,000
各档位的月薪拆分（参考）

A 顶配一线（北上广深强配）

链上 ¥75k×2；后端 ¥50k×2；前端 ¥45k×2；PM ¥40k×1 → 合计 ¥380k/月

B 主流档（大厂/远程混合）

链上 ¥55k×2；后端 ¥35k×2；前端 ¥32k×2；PM ¥30k×1 → 合计 ¥274k/月

C 精益承包（强执行、偏工程化）

链上 ¥40k×2；后端 ¥26k×2；前端 ¥24k×2；PM ¥20k×1 → 合计 ¥200k/月

基础设施（含云主机/DB/日志监控/CI/RPC/索引）：A=¥20k/月，B=¥12k/月，C=¥8k/月。

